strip.text = element_text(size = 12, face = "bold"),  # Texto de facetas más claro y destacado
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),  # Centrar y resaltar título
legend.position = "bottom",          # Mover leyenda a la parte inferior
legend.title = element_text(size = 12, face = "bold"),  # Resaltar título de la leyenda
legend.text = element_text(size = 10)  # Hacer texto de leyenda más legible
)
#opcion 3
ggplot(basesota_agrupada, aes(x = "", y = count, fill = clasificacion)) +
geom_bar(stat = "identity", width = 1) +  # Create a pie chart
coord_polar("y", start = 0) +  # Add rotation to align the chart
facet_grid(cepa ~ dia) +  # Separate by cepa and day
labs(
title = "Distribución de genes sobreexpresados por cepa y día",
fill = "Grupos de proteínas"
) +  # Add a more aesthetic color palette
theme_minimal() +
theme(
axis.title = element_blank(),        # Remove axis titles
axis.text = element_blank(),         # Remove axis text
axis.ticks = element_blank(),        # Remove axis ticks
panel.grid = element_blank(),        # Remove grid
strip.text = element_text(size = 12, face = "bold"),  # Highlight facet text
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),  # Center and highlight the title
legend.position = "bottom",          # Move the legend to the bottom
legend.title = element_text(size = 12, face = "bold"),  # Highlight the legend title
legend.text = element_text(size = 10),  # Make legend text more readable
plot.margin = margin(10, 10, 50, 10),  # Add margin below the plot to make room for legend
legend.margin = margin(t = 10)  # Add margin to the legend to avoid cutoff
)
#Se observa disminución de proteinas hipotéticas al dia28 en BC. Disminución de proteínas metabólicas sobreexpresadas. Menos proteínas de secreción, más proteínas de regulación transcripcional, proteínas de RNA o procesamiento y proteínas de transcripción y traducción.
#Para contraste, retirar los hipotéticos.
#En BL se observan las mismas tasas de grupos enzimáticos. Corroborando se encuentran los mismos tipos enzimáticos y los mismos genes. Lo siguiente es contrastar cantidades de cada una de estas enzimas.
#
#Opcion 2 estetizada se le pidió a chat gpt cambios estéticos
ggplot(basesota_agrupada, aes(x = "", y = count, fill = clasificacion)) +
geom_bar(stat = "identity", width = 1)+#linetype = "solid") +  # Bordes blancos para separar segmentos
coord_polar("y", start = 0) +  # Añade una rotación inicial para alinear el gráfico
facet_grid(cepa ~ dia) +  # Separa por cepa y día
labs(
title = "Distribución de genes sobreexpresados por cepa y día",
fill = "Grupos de proteínas"
) + # Cambiar paleta de colores a una más estética
theme_minimal() +
theme(
axis.title = element_blank(),        # Quitar títulos de ejes
axis.text = element_blank(),         # Quitar texto de ejes
axis.ticks = element_blank(),        # Quitar marcas de ejes
panel.grid = element_blank(),        # Quitar cuadrícula
strip.text = element_text(size = 12, face = "bold"),  # Texto de facetas más claro y destacado
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),  # Centrar y resaltar título
legend.position = "bottom",          # Mover leyenda a la parte inferior
legend.title = element_text(size = 12, face = "bold"),  # Resaltar título de la leyenda
legend.text = element_text(size = 10)  # Hacer texto de leyenda más legible
)
#opcion 3
ggplot(basesota_agrupada, aes(x = "", y = count, fill = clasificacion)) +
geom_bar(stat = "identity", width = 1) +  # Create a pie chart
coord_polar("y", start = 0) +  # Add rotation to align the chart
facet_grid(cepa ~ dia) +  # Separate by cepa and day
labs(
title = "Distribución de genes sobreexpresados por cepa y día",
fill = "Grupos de proteínas"
) +  # Add a more aesthetic color palette
theme_minimal() +
theme(
axis.title = element_blank(),        # Remove axis titles
axis.text = element_blank(),         # Remove axis text
axis.ticks = element_blank(),        # Remove axis ticks
panel.grid = element_blank(),        # Remove grid
strip.text = element_text(size = 12, face = "bold"),  # Highlight facet text
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),  # Center and highlight the title
legend.position = "bottom",          # Move the legend to the bottom
legend.title = element_text(size = 12, face = "bold"),  # Highlight the legend title
legend.text = element_text(size = 10),  # Make legend text more readable
plot.margin = margin(10, 10, 100, 10),  # Add extra space below the plot to avoid cutting off the legend
legend.margin = margin(t = 20),  # Increase the margin above the legend
legend.box.margin = margin(t = 20)) # Add margin above t
#opcion 3
ggplot(basesota_agrupada, aes(x = "", y = count, fill = clasificacion)) +
geom_bar(stat = "identity", width = 1) +  # Create a pie chart
coord_polar("y", start = 0) +  # Add rotation to align the chart
facet_grid(cepa ~ dia) +  # Separate by cepa and day
labs(
title = "Distribución de genes sobreexpresados por cepa y día",
fill = "Grupos de proteínas"
) +  # Add a more aesthetic color palette
theme_minimal() +
theme(
axis.title = element_blank(),        # Remove axis titles
axis.text = element_blank(),         # Remove axis text
axis.ticks = element_blank(),        # Remove axis ticks
panel.grid = element_blank(),        # Remove grid
strip.text = element_text(size = 12, face = "bold"),  # Highlight facet text
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),  # Center and highlight the title
legend.position = "bottom",          # Move the legend to the bottom
legend.title = element_text(size = 10, face = "bold"),  # Reduce the size of the legend title
legend.text = element_text(size = 8),  # Reduce the size of legend text
legend.key.width = unit(0.5, "inches"),  # Reduce the width of the legend keys
plot.margin = margin(10, 10, 100, 10),  # Add extra space below the plot
legend.margin = margin(t = 20),  # Increase the margin above the legend
legend.box.margin = margin(t = 20)  # Add margin above the legend box
)
#opcion 3
ggplot(basesota_agrupada, aes(x = "", y = count, fill = clasificacion)) +
geom_bar(stat = "identity", width = 1) +  # Create a pie chart
coord_polar("y", start = 0) +  # Add rotation to align the chart
facet_grid(cepa ~ dia) +  # Separate by cepa and day
labs(
title = "Distribución de genes sobreexpresados por cepa y día",
fill = "Grupos de proteínas"
) +  # Add a more aesthetic color palette
theme_minimal() +
theme(
axis.title = element_blank(),        # Remove axis titles
axis.text = element_blank(),         # Remove axis text
axis.ticks = element_blank(),        # Remove axis ticks
panel.grid = element_blank(),        # Remove grid
strip.text = element_text(size = 12, face = "bold"),  # Highlight facet text
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),  # Center and highlight the title
legend.position = "bottom",          # Move the legend to the bottom
legend.title = element_text(size = 10, face = "bold"),  # Reduce the size of the legend title
legend.text = element_text(size = 8),  # Reduce the size of legend text
legend.key.width = unit(0.5, "inches"),  # Reduce the width of the legend keys
legend.key.height = unit(0.5, "inches"),  # Make legend keys smaller in height
plot.margin = margin(10, 10, 100, 10),  # Add extra space below the plot
legend.margin = margin(t = 5, b = 5),  # Tighten the margin around the legend
legend.box.spacing = unit(0.2, "cm"),  # Reduce spacing between legend items
legend.box.margin = margin(t = 10)  # Add margin above the legend box
) +
guides(fill = guide_legend(keywidth = 1, keyheight = 1))  # Use square legend keys
#opcion 3
ggplot(basesota_agrupada, aes(x = "", y = count, fill = clasificacion)) +
geom_bar(stat = "identity", width = 1) +  # Create a pie chart
coord_polar("y", start = 0) +  # Add rotation to align the chart
facet_grid(cepa ~ dia) +  # Separate by cepa and day
labs(
title = "Distribución de genes sobreexpresados por cepa y día",
fill = "Grupos de proteínas"
) +  # Add a more aesthetic color palette
theme_minimal() +
theme(
axis.title = element_blank(),        # Remove axis titles
axis.text = element_blank(),         # Remove axis text
axis.ticks = element_blank(),        # Remove axis ticks
panel.grid = element_blank(),        # Remove grid
strip.text = element_text(size = 12, face = "bold"),  # Highlight facet text
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),  # Center and highlight the title
legend.position = "bottom",          # Move the legend to the bottom
legend.title = element_text(size = 10, face = "bold"),  # Reduce the size of the legend title
legend.text = element_text(size = 8),  # Reduce the size of legend text
legend.key.width = unit(0.5, "inches"),  # Reduce the width of the legend keys
legend.key.height = unit(0.5, "inches"),  # Make legend keys smaller in height
plot.margin = margin(20, 20, 150, 20),  # Add more space below the plot and reduce top/bottom margins
legend.margin = margin(t = 5, b = 5),  # Tighten the margin around the legend
legend.box.spacing = unit(0.2, "cm"),  # Reduce spacing between legend items
legend.box.margin = margin(t = 10)  # Add margin above the legend box
) +
guides(fill = guide_legend(keywidth = 1, keyheight = 1))  # Use square legend keys
#opcion 3
ggplot(basesota_agrupada, aes(x = "", y = count, fill = clasificacion)) +
geom_bar(stat = "identity", width = 1) +  # Create the pie chart
coord_polar("y", start = 0) +  # Add rotation to align the chart
facet_grid(cepa ~ dia) +  # Separate by cepa and day
labs(
title = "Distribución de genes sobreexpresados por cepa y día",
fill = "Grupos de proteínas"
) +  # Add a more aesthetic color palette
theme_minimal() +
theme(
axis.title = element_blank(),        # Remove axis titles
axis.text = element_blank(),         # Remove axis text
axis.ticks = element_blank(),        # Remove axis ticks
panel.grid = element_blank(),        # Remove grid
strip.text = element_text(size = 12, face = "bold"),  # Highlight facet text
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),  # Center and highlight the title
legend.position = "bottom",          # Move the legend to the bottom
legend.title = element_text(size = 10, face = "bold"),  # Reduce the size of the legend title
legend.text = element_text(size = 8),  # Reduce the size of legend text
legend.key.width = unit(0.5, "inches"),  # Reduce the width of the legend keys
legend.key.height = unit(0.5, "inches"),  # Make legend keys smaller in height
plot.margin = margin(10, 10, 50, 10),  # Reduce the bottom margin for a larger pie chart area
legend.margin = margin(t = 5, b = 5),  # Tighten the margin around the legend
legend.box.spacing = unit(0.2, "cm"),  # Reduce spacing between legend items
legend.box.margin = margin(t = 10)  # Add margin above the legend box
) +
guides(fill = guide_legend(keywidth = 1, keyheight = 1))  # Use square legend keys
#Expresiones diferenciales
#install.packages("openxlsx")
#install.packages("viridis")
library(openxlsx)
library(tidyverse)
library(conflicted)
library(viridis)
#BC391
BCvsBL_D14 <- dfExpresiónmasenBCqueBL #las sobrerepresentadas de BC
#BL323
BLvsBC_D14 <- dfExpresiónmasenBLqueBC #las sobrerepresentadas de BL
#by time 28
#BC391
BCvsBL_D28 <- dfExpresiónmasenBCqueBLD28 #sobrerepresentados en BCD28 vs BLD28
#BL323
BLvsBC_D28 <- dfExpresiónmasenBLqueBCD28 #sobrerepresentados en BLD28 vs BCD28
#14 vs 28 BC
BC14vsBC28 <- dfExpresiónmasenBC14queBC28 #sobrerepresentadas en BC14 vs BC28
BC28vsBC14 <- dfExpresiónmasenBC28queBC14 #sobrerepresentadas en BC28 vs BC14
#14 vs 28 BL
BL14vsBL28 <- dfExpresiónmasenBL14queBL28 #sobrerepresentados en BL14 vs BL28
BL28vsBL14 <- dfExpresiónmasenBL28queBL14 #sobrerepresentados en BL28 vs BL14
#normalización puede jugar en contra aunque diga que una es mayor que la otra va a ser tomado como hay presencia en la muestra.
#Están sacadas de contexto.
workbookDEG <- createWorkbook()
addWorksheet(workbookDEG, "BCvsBL_D14")
writeData(workbookDEG, "BCvsBL_D14", BCvsBL_D14, rowNames = T)
addWorksheet(workbookDEG, "BLvsBC_D14")
writeData(workbookDEG, "BLvsBC_D14", BLvsBC_D14, rowNames = T)
addWorksheet(workbookDEG, "BCvsBL_D28")
writeData(workbookDEG, "BCvsBL_D28", BCvsBL_D28, rowNames = T)
addWorksheet(workbookDEG, "BLvsBC_D28")
writeData(workbookDEG, "BLvsBC_D28", BLvsBC_D28, rowNames = T)
addWorksheet(workbookDEG, "BC14vsBC28")
writeData(workbookDEG, "BC14vsBC28", BC14vsBC28, rowNames = T)
addWorksheet(workbookDEG, "BC28vsBC14")
writeData(workbookDEG, "BC28vsBC14", BC28vsBC14, rowNames = T)
addWorksheet(workbookDEG, "BL14vsBL28")
writeData(workbookDEG, "BL14vsBL28", BL14vsBL28, rowNames = T)
addWorksheet(workbookDEG, "BL28vsBL14")
writeData(workbookDEG, "BL28vsBL14", BL28vsBL14, rowNames = T)
saveWorkbook(workbookDEG, file = "BCvsBL_D14andD28.xlsx",  overwrite = TRUE)
#Datos ya con descripción DEG
#todo en referencia a comparación BL vs BC.
#comparación al día 14
data_DEG_BCD14 <- read.xlsx("C:/Users/david/1.Archivos-Directorios/1. Maestría/0Tesis Maestría/1. AT en R/2. Transcriptomic Analysis Mastery in Immunology/BCvsBL_D14andD28_descrito.xlsx", sheet = 1)
data_DEG_BLD14 <- read.xlsx("C:/Users/david/1.Archivos-Directorios/1. Maestría/0Tesis Maestría/1. AT en R/2. Transcriptomic Analysis Mastery in Immunology/BCvsBL_D14andD28_descrito.xlsx", sheet = 2)
#colnames(data_DEG_BCD14)
#comparación al día 28
data_DEG_BCD28 <- read.xlsx("C:/Users/david/1.Archivos-Directorios/1. Maestría/0Tesis Maestría/1. AT en R/2. Transcriptomic Analysis Mastery in Immunology/BCvsBL_D14andD28_descrito.xlsx", sheet = 3)
data_DEG_BLD28 <- read.xlsx("C:/Users/david/1.Archivos-Directorios/1. Maestría/0Tesis Maestría/1. AT en R/2. Transcriptomic Analysis Mastery in Immunology/BCvsBL_D14andD28_descrito.xlsx", sheet = 4)
#comparación BCD14 vs BCD28
data_DEG_BCD14v28 <- read.xlsx("C:/Users/david/1.Archivos-Directorios/1. Maestría/0Tesis Maestría/1. AT en R/2. Transcriptomic Analysis Mastery in Immunology/BCvsBL_D14andD28_descrito.xlsx", sheet = 5)
data_DEG_BCD28v14 <- read.xlsx("C:/Users/david/1.Archivos-Directorios/1. Maestría/0Tesis Maestría/1. AT en R/2. Transcriptomic Analysis Mastery in Immunology/BCvsBL_D14andD28_descrito.xlsx", sheet = 6)
#comparación BLD14 vs BLD28
data_DEG_BLD14v28 <- read.xlsx("C:/Users/david/1.Archivos-Directorios/1. Maestría/0Tesis Maestría/1. AT en R/2. Transcriptomic Analysis Mastery in Immunology/BCvsBL_D14andD28_descrito.xlsx", sheet = 7)
data_DEG_BLD28v14 <- read.xlsx("C:/Users/david/1.Archivos-Directorios/1. Maestría/0Tesis Maestría/1. AT en R/2. Transcriptomic Analysis Mastery in Immunology/BCvsBL_D14andD28_descrito.xlsx", sheet = 8)
lista_data <- list(data_DEG_BCD14, data_DEG_BCD28, data_DEG_BLD14, data_DEG_BLD28,
data_DEG_BCD14v28, data_DEG_BCD28v14, data_DEG_BLD14v28, data_DEG_BLD28v14)
str(lista_data)
funcion_columnas_deseadas <- function(df){
df %>%
select(gen, baseMean, log2FoldChange, Nombre.de.gén) %>%
rename(base_mean = baseMean, log2fc = log2FoldChange, genename = Nombre.de.gén)
}
bases_de_datos_filtradas <- sapply(lista_data, funcion_columnas_deseadas)
str(bases_de_datos_filtradas) #tiene 32 filas quiero dataframes de 4 columnas
separar_lista <- function(lista) {
# Dividir la lista en 8 partes, cada una con 4 elementos
lista_separada <- split(lista, ceiling(seq_along(lista) / 4))
# Devolver la lista de listas separadas
return(lista_separada)
}
bases_filtradas_en_lista <- separar_lista(bases_de_datos_filtradas)
str(bases_filtradas_en_lista)
view(bases_de_datos_filtradas)
BCD14 <- data.frame(bases_filtradas_en_lista[1])
BLD14 <- data.frame(bases_filtradas_en_lista[2])
BCD28 <- data.frame(bases_filtradas_en_lista[3])
BLD28 <- data.frame(bases_filtradas_en_lista[4])
BCD14vs28 <- data.frame(bases_filtradas_en_lista[5])
BCD28v14 <- data.frame(bases_filtradas_en_lista[6])
BLD14v28 <- data.frame(bases_filtradas_en_lista[7])
BLD28v14 <- data.frame(bases_filtradas_en_lista[8])
colnamesdf = c("gen", "base_mean", "log2fc", "geneproduct")
colnames(BCD14) <- colnamesdf
colnames(BLD14) <- colnamesdf
colnames(BCD28) <- colnamesdf
colnames(BLD28) <- colnamesdf
colnames(BCD14vs28) <- colnamesdf
colnames(BCD28v14) <- colnamesdf
colnames(BLD14v28) <- colnamesdf
colnames(BLD28v14) <- colnamesdf
lista_para_basesota <- list(BCD14, BLD14, BCD28, BLD28,  BCD14vs28, BCD28v14, BLD14v28, BLD28v14)
view(BCD14)
#Base de datos junta en proceso
#corregido_lista_basesota <- lapply(lista_para_basesota, function(df){
#  df %>%
#    mutate(log2fc = as.numeric(log2fc))
#})
basesota <- bind_rows(lista_para_basesota)
#Base de datos junta en proceso
#corregido_lista_basesota <- lapply(lista_para_basesota, function(df){
#  df %>%
#    mutate(log2fc = as.numeric(log2fc))
#})
basesota <- bind_rows(lista_para_basesota)
#quizá anotar que viene de cual comparación para separarlo por separación ejemplo BCvsBL o BLvsBL y BCvsBC.
#arreglar basesota. ponerle columna de cepa, columna de día,
basesota$cepa = c(rep("BC", times = 20), rep("BL", times = 20), rep("BC", times = 20), rep("BL", times = 20),
rep("BC", times = 40), rep("BL", times = 40))
basesota$dia = c(rep("D14", times = 40), rep("D28", times = 40), rep("D14", times = 20), rep("D28", times = 20),
rep("D14", times = 20), rep("D28", times = 20))
basesota$ref_comp = c(rep("bcd14vsbld14", times = 40), rep("bcd28vsbld28", times = 40), rep("bcd14vsbcd28", times = 40), rep("bld14vsbld28", times = 40))
#ocupo conseguir información sobre clasificación y subclasificación supongo iniciaré con información no técnica
basesota$clasificacion = c() #160 fucking valores. si salieron.
gene_product_unique <- unique(basesota$geneproduct)
#no me ha salido el for me iré a python así que haré un excel
basesotaDEG <- createWorkbook()
addWorksheet(basesotaDEG, "BaseDEG")
writeData(basesotaDEG, "BaseDEG", basesota, rowNames = T)
saveWorkbook(basesotaDEG, file = "BCvsBL_DEGppython.xlsx",  overwrite = TRUE)
#Importar excel
basesota_clasificada <- read.xlsx("C:/Users/david/1.Archivos-Directorios/1. Maestría/0Tesis Maestría/1. AT en R/2. Transcriptomic Analysis Mastery in Immunology/genesDEGMtb.xlsx", sheet = 1)
view(basesota_clasificada)
#Importar excel
basesota_clasificada <- read.xlsx("C:/Users/david/1.Archivos-Directorios/1. Maestría/0Tesis Maestría/1. AT en R/2. Transcriptomic Analysis Mastery in Immunology/genesDEGMtb.xlsx", sheet = 1)
view(basesota_clasificada)
#Importar excel
basesota_clasificada <- read.xlsx("C:/Users/david/1.Archivos-Directorios/1. Maestría/0Tesis Maestría/1. AT en R/2. Transcriptomic Analysis Mastery in Immunology/genesDEGMtb.xlsx", sheet = 1)
view(basesota_clasificada)
colnames(basesota_clasificada) #Listo
basesota_agrupada <- basesota_clasificada %>%
group_by(cepa, dia, ref_comp, clasificacion) %>%
summarise(count = n(), .groups = "drop")
view(basesota_agrupada)
#formar pie. #Revisar los colores, si ponerle lineas, conteos, considerar quitar datos. Revisar que si tengo los datos de entrada correctos porque parece replica el D14 y D28 de BL.
ggplot(basesota_agrupada, aes(x = "", y = count, fill = clasificacion)) +
geom_bar(stat = "identity", width = 1) +  # Create a stacked bar chart
coord_polar("y") +  # Convert to pie chart
facet_grid(cepa ~ dia) +  # Separate by strain and day
labs(title = "Distribución de genes sobreexpresados por cepa y día",
fill = "Grupos de proteínas") +
theme_minimal() +
theme(axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.title = element_text(hjust = 0.5))
#formar pie. #Revisar los colores, si ponerle lineas, conteos, considerar quitar datos. Revisar que si tengo los datos de entrada correctos porque parece replica el D14 y D28 de BL.
ggplot(basesota_agrupada, aes(x = "", y = count, fill = clasificacion)) +
geom_bar(stat = "identity", width = 1) +  # Create a stacked bar chart
coord_polar("y") +  # Convert to pie chart
facet_grid(cepa ~ dia ~ ref_comp) +  # Separate by strain and day
labs(title = "Distribución de genes sobreexpresados por cepa y día",
fill = "Grupos de proteínas") +
theme_minimal() +
theme(axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.title = element_text(hjust = 0.5))
#Se observa disminución de proteinas hipotéticas al dia28 en BC. Disminución de proteínas metabólicas sobreexpresadas. Menos proteínas de secreción, más proteínas de regulación transcripcional, proteínas de RNA o procesamiento y proteínas de transcripción y traducción.
#Para contraste, retirar los hipotéticos.
#En BL se observan las mismas tasas de grupos enzimáticos. Corroborando se encuentran los mismos tipos enzimáticos y los mismos genes. Lo siguiente es contrastar cantidades de cada una de estas enzimas.
#
#Opcion 2 estetizada se le pidió a chat gpt cambios estéticos
ggplot(basesota_agrupada, aes(x = "", y = count, fill = clasificacion)) +
geom_bar(stat = "identity", width = 1)+#linetype = "solid") +  # Bordes blancos para separar segmentos
coord_polar("y", start = 0) +  # Añade una rotación inicial para alinear el gráfico
facet_grid(cepa ~ ref_comp) +  # Separa por cepa y día
labs(
title = "Distribución de genes sobreexpresados por cepa y día",
fill = "Grupos de proteínas"
) + # Cambiar paleta de colores a una más estética
theme_minimal() +
theme(
axis.title = element_blank(),        # Quitar títulos de ejes
axis.text = element_blank(),         # Quitar texto de ejes
axis.ticks = element_blank(),        # Quitar marcas de ejes
panel.grid = element_blank(),        # Quitar cuadrícula
strip.text = element_text(size = 12, face = "bold"),  # Texto de facetas más claro y destacado
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),  # Centrar y resaltar título
legend.position = "bottom",          # Mover leyenda a la parte inferior
legend.title = element_text(size = 12, face = "bold"),  # Resaltar título de la leyenda
legend.text = element_text(size = 10)  # Hacer texto de leyenda más legible
)
#Se observa disminución de proteinas hipotéticas al dia28 en BC. Disminución de proteínas metabólicas sobreexpresadas. Menos proteínas de secreción, más proteínas de regulación transcripcional, proteínas de RNA o procesamiento y proteínas de transcripción y traducción.
#Para contraste, retirar los hipotéticos.
#En BL se observan las mismas tasas de grupos enzimáticos. Corroborando se encuentran los mismos tipos enzimáticos y los mismos genes. Lo siguiente es contrastar cantidades de cada una de estas enzimas.
#
#Opcion 2 estetizada se le pidió a chat gpt cambios estéticos
ggplot(basesota_agrupada, aes(x = "", y = count, fill = clasificacion)) +
geom_bar(stat = "identity", width = 1)+#linetype = "solid") +  # Bordes blancos para separar segmentos
coord_polar("y", start = 0) +  # Añade una rotación inicial para alinear el gráfico
facet_grid(cepa ~ día ~ ref_comp) +  # Separa por cepa y día
labs(
title = "Distribución de genes sobreexpresados por cepa y día",
fill = "Grupos de proteínas"
) + # Cambiar paleta de colores a una más estética
theme_minimal() +
theme(
axis.title = element_blank(),        # Quitar títulos de ejes
axis.text = element_blank(),         # Quitar texto de ejes
axis.ticks = element_blank(),        # Quitar marcas de ejes
panel.grid = element_blank(),        # Quitar cuadrícula
strip.text = element_text(size = 12, face = "bold"),  # Texto de facetas más claro y destacado
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),  # Centrar y resaltar título
legend.position = "bottom",          # Mover leyenda a la parte inferior
legend.title = element_text(size = 12, face = "bold"),  # Resaltar título de la leyenda
legend.text = element_text(size = 10)  # Hacer texto de leyenda más legible
)
#Se observa disminución de proteinas hipotéticas al dia28 en BC. Disminución de proteínas metabólicas sobreexpresadas. Menos proteínas de secreción, más proteínas de regulación transcripcional, proteínas de RNA o procesamiento y proteínas de transcripción y traducción.
#Para contraste, retirar los hipotéticos.
#En BL se observan las mismas tasas de grupos enzimáticos. Corroborando se encuentran los mismos tipos enzimáticos y los mismos genes. Lo siguiente es contrastar cantidades de cada una de estas enzimas.
#
#Opcion 2 estetizada se le pidió a chat gpt cambios estéticos
ggplot(basesota_agrupada, aes(x = "", y = count, fill = clasificacion)) +
geom_bar(stat = "identity", width = 1)+#linetype = "solid") +  # Bordes blancos para separar segmentos
coord_polar("y", start = 0) +  # Añade una rotación inicial para alinear el gráfico
facet_grid(cepa ~ dia ~ ref_comp) +  # Separa por cepa y día
labs(
title = "Distribución de genes sobreexpresados por cepa y día",
fill = "Grupos de proteínas"
) + # Cambiar paleta de colores a una más estética
theme_minimal() +
theme(
axis.title = element_blank(),        # Quitar títulos de ejes
axis.text = element_blank(),         # Quitar texto de ejes
axis.ticks = element_blank(),        # Quitar marcas de ejes
panel.grid = element_blank(),        # Quitar cuadrícula
strip.text = element_text(size = 12, face = "bold"),  # Texto de facetas más claro y destacado
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),  # Centrar y resaltar título
legend.position = "bottom",          # Mover leyenda a la parte inferior
legend.title = element_text(size = 12, face = "bold"),  # Resaltar título de la leyenda
legend.text = element_text(size = 10)  # Hacer texto de leyenda más legible
)
library(Rsamtools)
library(Rsubread)
library(ShortRead)
library(DESeq2)
library(stringr)
library(magrittr)
library(tidyverse)
library(ggplot2)
library(conflicted)
library(pheatmap)
p_0.05BC <- if(resBCyBLv$pvalue < 0.05)
print(p_0.05BC)
print(resBCyBLv)
view(resBCyBLv)
conflicted::conflicts_prefer(tibble::view)
view(resBCyBLv)
resBCyBLv$significance <- ifelse(resBCyBLv$pvalue < 0.05, "Significant", "Not significant") & abs(resBCyBLv$log2FoldChange) > 1
top_genes_BL_pval_0.05 <- top_genes(top_genes$pvalue<0.05)
top_genes_BL_pval_0.05 <- top_genes[top_genes$pvalue<0.05]
top_genes_BL_pval_0.05 <- top_genesmore[top_genesmore$pvalue<0.05]
top_genes_BL_pval_0.05 <- top_genes[top_genes$pvalue<0.05]
top_genes_BC_pval_0.05 <- top_genesmore[top_genesmore$pvalue<0.05]
view(top_genes_BL_pval_0.05)
view(top_genes_BC_pval_0.05)
# Réplica al día 28 BC y BL hasta alineamientos ---------------------------------------------------
#librerías
library(Rsamtools)
library(Rsubread)
library(ShortRead)
library(DESeq2)
library(stringr)
library(magrittr)
library(tidyverse)
library(ggplot2)
library(conflicted)
library(pheatmap)
top_genes_BLD28_pval_0.05 <- top_genesBLD28[top_genesBLD28$pvalue<0.05]
top_genes_BCD28_pval_0.05 <- top_genesBCD28[top_genesBCD28$pvalue<0.05]
view(top_genes_BCD28_pval_0.05)
view(top_genes_BLD28_pval_0.05)
view(resBCD28yBLD28v)
resBCD28yBLD28v$significance <- ifelse(resBCD28yBLD28v$pvalue < 0.05, "Significant", "Not significant") #& abs(resBCyBLv$log2FoldChange) > 1,
resBCD28yBLD28v$significancepval <- ifelse(resBCD28yBLD28v$significance == "Significant", "Yes", "No" )
#resBCyBLv$ifpval <-
top_genesBLD28 <- head(resBCD28yBLD28v[order(resBCD28yBLD28v$log2FoldChange), ], 20)  # Adjust number of top genes as needed
top_genesBCD28 <- head(resBCD28yBLD28v[order(resBCD28yBLD28v$log2FoldChange, decreasing = T), ], 20)  # Adjust number of top genes as needed
top_genes_BLD28_pval_0.05 <- top_genesBLD28[top_genesBLD28$pvalue<0.05]
top_genes_BCD28_pval_0.05 <- top_genesBCD28[top_genesBCD28$pvalue<0.05]
view(top_genesBLD28)
view(top_genesBCD28)
view(top_genes_BCD28_pval_0.05)
view(top_genes_BLD28_pval_0.05)
view(top_genes_BCD28_pval_0.05)
view(top_genes_BLD28_pval_0.05)
#resBCyBLv$ifpval <-
top_genesBCD14v28 <- head(resBCD14yBCD28v[order(resBCD14yBCD28v$log2FoldChange), ], 10)  # Adjust number of top genes as needed
top_genesBCD28v14 <- head(resBCD14yBCD28v[order(resBCD14yBCD28v$log2FoldChange, decreasing = T), ], 10)  # Adjust number of top genes as needed
view(top_genesBCD14v28)
view(top_genesBCD28v14)
view(top_genesBLD14v28)
view(top_genesBLD28v14)
view(top_genes_BL_pval_0.05)
#resBCyBLv$ifpval <-
top_genes <- head(resBCyBLv[order(resBCyBLv$log2FoldChange), ], 10)  # Adjust number of top genes as needed
view(top_genes)
view(top_genes_more)
view(top_genesmore)
view(top_genesBLD28)
library(Rsamtools)
library(Rsubread)
library(ShortRead)
library(DESeq2)
library(stringr)
library(magrittr)
library(tidyverse)
library(ggplot2)
library(conflicted)
library(pheatmap)
NormalizadoBCyBL <- DESeq(ddsBCyBL)
head(counts(NormalizadoBCyBL, normalized = T))
conteos_normalizadosBCyBL <- counts(NormalizadoBCyBL, normalized = T)
view(conteos_normalizadosBCyBL)
conflicted::conflicts_prefer(tibble::view)
view(conteos_normalizadosBCyBL)
head(BCyBLvst)
resBCyBLcol <- results(ddsBCyBLcolapsadoRT, contrast = c("cepa", "BL323", "BC391"))
view(resBCyBLcol)
view(top_genesBCmas)
pheatmap(mat) #normalización juega en contra. BC es la que aparece sobreexpresando. Interesante revisar a detalle esas expresiones de todas formas.
